
2018-10-13 by zxw

1.完善了修改基础表相关的表结构。
2.调整了其它相关的表结构中的错误部份，保证生成的sql可以直接生成数据库
3.编译生成了一份.net2.0可以用的Dapper，习惯了ORM后，不想写这么多SQL了。。。
4.找了一个.Net2.0可以用的Linq，写习惯了，没有真不方便。。。
5.为了偷懒不想写实体类，写了一个存储过程用于生成实体类，可以生成类了，包括类注释及列注释，一行代码也不用写了（参见下面的PD配置，使生成的SQL中带注释即可）
6,顺手为了偷懒不想insert update delete select写了一个存储过程可以生成这四条了。
7.编写了一个Dapper使用的例子。
8.加了全局异常处理，现在引用了log4net，代码还没写

PS:PowerDesign使用列名生成注释的方法见此文章 https://www.cnblogs.com/duanxz/p/3792723.html 
文章中是sqlserver的修改为 mysql 的column的配置为：alter table %TABLE% modify column %COLUMN%  %DATATYPE% comment %.q:COLNNAME%



2018-10-16 by zxw
对Dapper的事务和查询等进行了一层封装。Bll和Dal封装完成
用户查询接口走通，后续就是业务逻辑了。

2018-10-17 by zxw
完成了用户管理所有的功能。
过程中，调整了一些框架的代码，提交后续规范性和编码效率。
请仔细看一下用户管理的整体流程，保证后续统一的规范。
特别注意LayoutControl，为了减少代码量，控件的可见不可见不从代码中处理，而使用Custom后，导出的xml编译到文件中处理。程序框架中已经对这块进行了优化，可以很少代码实现功能。
这几天的主要功能都是在框架上，目前为止，已正常走完了一个完整的业务，框架要调整的东西不多了，后续主要就是实现业务


2018-10-20 by zxw
完成了角色管理所有功能。
完成部门管理的基本结构和查询。
完成了用户中和部门管理，角色管理联动部份。
调整了用户管理中，相关部门，角色显示名称而不再显示Code。
完成了登录管理。数据库中的密码为加密密码。 1的密码值为：6B86B273FF34FCE19D6B804EFF5A3F5747ADA4EAA22F1D49C01E52DDB7875B4B



2018-10-20 by Jason
在Dal层增加了DapperExtensions，目前扩展了Insert方法，用于Insert有自增列数据时返回自增列的值 
完成供应商管理相关编辑功能，暂缺审批流程控制
完成收、付款表结构整理

PS:PowerDesign使用列名生成注释的方法可参考 https://www.cnblogs.com/kangxuebin/articles/3688146.html
   之前的修改方法会修改列的非空、自增等属性，且是每列生成了alter table column 相关Sql

需确定事项
	UI布局从xml中加载，如果界面新增控件（字段）则需要几乎修改所有相应的XML？ 可否待所有字段确认之后，再添加相对应xml配置？


2018-10-21 by zxw
完成了部门管理
优化了Layout加载xml的调用逻辑，考虑到会有多种工作模式使用的是同一个界面，每个都保存麻烦，支持调用时传入工作模式，后续我还想再优化加入一个ViewModel来彻底解决这个问题。
简单测试了用户管理，角色管理和部门管理的功能。

2018-10-21 by Jason
完成了客户管理相关编辑功能，国家信息目前是输入后续改为从配置项中选择，港口信息待确定

2018-10-23 by Jason
完成了预算单的基本管理功能（选择买方、工厂、业务员等暂没实现，部分字段还待确认）

Ps:使用Dapper查询时当返回对象属性中包含枚举类型时类型转换出错，待明天处理解决

注，我是从很老的Dapper分支拉出来的代码，可能不支持枚举，可以建两个属性来对应

 2018-10-23 by zxw
整理完了流程相关的数据库及业务逻辑。
此部份的原始考虑时未考虑流程版本的问题，现加上，预计工作量比原计算会大不少。预计会增加2天的工作量。
目前正在编码中，相关代码处于不可编辑状态，先不提交了。只提交PD文件，避免后续冲突。
处理点：关于流程打回处理，现行方法如下：

        //简单点处理，不考虑打回的，如果审批不通过，直接发回给原点。这里就有一个问题了，是手工重新发起流程，还是数据作废？
        //在流程引擎上处理
        //1.如果直接作废，那引擎不需要再多的处理。在个人确认完成数据后，业务删除数据即可
        //2.如果手工再发起流程，业务那边可以加一个按钮，重新发起流程，引擎端提交接口处理，重新发起流程时检查未审批通过或未审批过。
        //目前先计划按方法2处理。


2018-10-25 by Jason
	调整PD，增加演示内置数据
	整合流程相关表结构
	收款部分代码提交

2018-10-25 by zxw
	调整了流程相关的表结构
	完成了流程管理相关的部分功能。。

	
2018-10-26 by Jason
	完成付款管理基础功能

2018-10-26 by zxw
	流程管理已经完成了，后续流程还差，引擎驱动的API及流程相关的两个界面，预计周末可以写完，然后需要和业务模块对应了做联动

2018-10-27 by zxw
	流程的驱动已经写完了。这块逻辑比较复杂，我还没有仔细核对逻辑有没有问题。
	流程部份后续可以准备集成了。

2018-10-27 by zxw
	流程的驱动已经测试完成了，问题都已经修复完成。
	待审批界面还未处理，这里需要定一下具体怎么操作后才能动手。
	然后流程的基本数据现我前天写完流程配置的时候就已经提交过来，看数据建模里的Init文件里有的。
	PS:我这里的生成的Mysql不知道为什么存在自增主键盘没有配置的情况，不知道你通过建模文件会不会有同样问题。我把我的数据库导了一份出来，扔在Design里了，可以参见

2018-10-30 by Jason
	完成配置功能，目前只增加了国家和港口的配置
	完善付款核算部分细则。

2018-11-03 by zxw
	流程待审批的单子已完成。
	流程审批界面已完成。
	
2018-11-03 by zxw
	我提交的单子已完成。
	至此流程相关的功能都基本完成了，下一阶段目标是角色及权限相关的功能。。

2018-11-05 by zxw
	角色权限分配的界面做好了。
	角色管理模板的角色怎么定义做好了，
	调整了一些工程结构，把操作定义扔到Entity里了。


2018-11-06 by zxw
	权限定义这块都已经完成了，见Entity工程中的Permission类
	角色权限分配功能已完成
	后一步做全局的权限控制


2018-11-07 by zxw
	Ribbon上主菜单的权限已经实现了，请处理，新增的主菜单上的Tag上配置一个这个菜单对应的BusinessModule
	QueryForm上新增了一个属性Module用于记录这个窗体对应的Module，以加载权限的，请在每个窗体上配置一下这个值，我不改你的窗体了，以免冲突。
	QueryForm上新增了注册表格双击的事件，正常情况下不用管理了，我会自己查找GridView并注册双击事件的，业务模块只需要配置一下Action的映射关系就行了，支持双层配置，用于处理没有修改权限时，双击自动改为查看的逻辑
	QueryForm上新增了验证权限的方法，用于处理一些特殊的权限事件，例如我的角色分配这类在查询界面上的按钮事件。
	注意，如果选不去配置权限，可以先处理MainForm里的权限检查事件，不然你的功能都被禁止了。

2018-11-15 by zxw
	报表统计的逻辑基本想清楚了，界面也做好了，明天写逻辑事件


2018-11-16 by zxw
	报表统计模块都完成了，请参见测试报表样例

	
2018-11-20 by Jason
	流程审批过程中是否缺少流程图？
	

2018-11-22 by zxw
	流程新增撤回操作。现在的我提交的单子模块集成进去了，考虑到驳回操作需要显示还未审批的，优化流程过程的未审批节点的显示 。
	流程提交新增了字段DateItemText,用于处理工作台的显示 。